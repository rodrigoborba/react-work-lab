
import { getUserFromToken, getCNPJFromToken, getKeyFromToken } from './AuthUtils'

describe('Testes componente utilitário autenticação ', () =>{

    test('Recuperar username do usuário logado', () => {
        expect(
            getUserFromToken('"eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJITDFwSlJiUWFwenhkZkFiMDlwOUMxMmx4NDlfRTNUZXJGajRWamZUdWprIn0.eyJqdGkiOiJhMzBlNmZmNS04OTY3LTQxZGMtYTdmNS04NzhmYzM2NjcwZmEiLCJleHAiOjE2MDcwMjI5NDUsIm5iZiI6MCwiaWF0IjoxNjA3MDIyMDQ1LCJpc3MiOiJodHRwczovL3Myc3NvZDAyLmRyZWFkcy5ibmI6ODQ0My9hdXRoL3JlYWxtcy9EZXYtSW50ZXIiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiMGVhN2YwYTAtZTMyZi00NWQwLTkxNWUtNWZjZWQwOWFkMjhlIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiczU0OS1lbXByZXNhLXdlYiIsIm5vbmNlIjoiNzFiODY1NzgtNjQ1OC00Zjg3LTg2YmEtODg1MzJkNjcxMjgwIiwiYXV0aF90aW1lIjoxNjA3MDIyMDQ1LCJzZXNzaW9uX3N0YXRlIjoiZjU0MWNmYTMtZDlhNS00NmZjLWExOTAtZTJiZmI0ZTQ5NzFhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwczovL3M1NDktZW1wcmVzYS5kZXYub2NwLmRyZWFkcy5ibmIiLCJodHRwOi8vbG9jYWxob3N0OjMwMDAiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbIm9mZmxpbmVfYWNjZXNzIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCIsInVzZXJGZWRlcmF0aW9uIjoiRVhUUkEiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJjMDE3NDM2IiwiY25waiI6IjczMTQxOTM5MDAwMTQwIiwiZ2l2ZW5fbmFtZSI6IkJydW5vIEJKLiBKb3Jkw6NvIiwibm9tZVRyYXRhbWVudG8iOiJCcnVubyJ9.O_ClhNiv8RwZ5pGLNZFAm0EYprfMEusDlzySznkJwGcGEUGWT99bLU1wcUm6dGTCmRJiA1c0_igNdsc-pg0mTJWn9aM3sQBhzBMIep-dY04gTvNPnTcjfJGT30ven3yiHA3iXxVBi5g3ODy8Cl-nkMll5OvdUxON5sMIx8-aldtg2nzDoKZna-kMSERpOzY0uZBRZd0zjHAmt1d5Rbe7HSFmBn6spLOGW5K4WsZUzwrsMD3OVm8Lv-P-OMQpKAISWCZlmz1luMqxSEG3JMV_E2P9u19kjPWjWyH7uhEnDcEgt91LtLajk4hNDkiqqWNxAiIhOL829JrYfwO1zi_NrQ"'))
            .toBe('c017436');
    });

    test('Recuperar cnpj do token', () => {
        expect(
            getCNPJFromToken('"eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJITDFwSlJiUWFwenhkZkFiMDlwOUMxMmx4NDlfRTNUZXJGajRWamZUdWprIn0.eyJqdGkiOiJhMzBlNmZmNS04OTY3LTQxZGMtYTdmNS04NzhmYzM2NjcwZmEiLCJleHAiOjE2MDcwMjI5NDUsIm5iZiI6MCwiaWF0IjoxNjA3MDIyMDQ1LCJpc3MiOiJodHRwczovL3Myc3NvZDAyLmRyZWFkcy5ibmI6ODQ0My9hdXRoL3JlYWxtcy9EZXYtSW50ZXIiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiMGVhN2YwYTAtZTMyZi00NWQwLTkxNWUtNWZjZWQwOWFkMjhlIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiczU0OS1lbXByZXNhLXdlYiIsIm5vbmNlIjoiNzFiODY1NzgtNjQ1OC00Zjg3LTg2YmEtODg1MzJkNjcxMjgwIiwiYXV0aF90aW1lIjoxNjA3MDIyMDQ1LCJzZXNzaW9uX3N0YXRlIjoiZjU0MWNmYTMtZDlhNS00NmZjLWExOTAtZTJiZmI0ZTQ5NzFhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwczovL3M1NDktZW1wcmVzYS5kZXYub2NwLmRyZWFkcy5ibmIiLCJodHRwOi8vbG9jYWxob3N0OjMwMDAiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbIm9mZmxpbmVfYWNjZXNzIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCIsInVzZXJGZWRlcmF0aW9uIjoiRVhUUkEiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJjMDE3NDM2IiwiY25waiI6IjczMTQxOTM5MDAwMTQwIiwiZ2l2ZW5fbmFtZSI6IkJydW5vIEJKLiBKb3Jkw6NvIiwibm9tZVRyYXRhbWVudG8iOiJCcnVubyJ9.O_ClhNiv8RwZ5pGLNZFAm0EYprfMEusDlzySznkJwGcGEUGWT99bLU1wcUm6dGTCmRJiA1c0_igNdsc-pg0mTJWn9aM3sQBhzBMIep-dY04gTvNPnTcjfJGT30ven3yiHA3iXxVBi5g3ODy8Cl-nkMll5OvdUxON5sMIx8-aldtg2nzDoKZna-kMSERpOzY0uZBRZd0zjHAmt1d5Rbe7HSFmBn6spLOGW5K4WsZUzwrsMD3OVm8Lv-P-OMQpKAISWCZlmz1luMqxSEG3JMV_E2P9u19kjPWjWyH7uhEnDcEgt91LtLajk4hNDkiqqWNxAiIhOL829JrYfwO1zi_NrQ"'))
            .toBe('73141939000140');
    });

    test('Recuperar username do usuário logado', () => {
        expect(
            getKeyFromToken('cnpj', '"eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJITDFwSlJiUWFwenhkZkFiMDlwOUMxMmx4NDlfRTNUZXJGajRWamZUdWprIn0.eyJqdGkiOiJhMzBlNmZmNS04OTY3LTQxZGMtYTdmNS04NzhmYzM2NjcwZmEiLCJleHAiOjE2MDcwMjI5NDUsIm5iZiI6MCwiaWF0IjoxNjA3MDIyMDQ1LCJpc3MiOiJodHRwczovL3Myc3NvZDAyLmRyZWFkcy5ibmI6ODQ0My9hdXRoL3JlYWxtcy9EZXYtSW50ZXIiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiMGVhN2YwYTAtZTMyZi00NWQwLTkxNWUtNWZjZWQwOWFkMjhlIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiczU0OS1lbXByZXNhLXdlYiIsIm5vbmNlIjoiNzFiODY1NzgtNjQ1OC00Zjg3LTg2YmEtODg1MzJkNjcxMjgwIiwiYXV0aF90aW1lIjoxNjA3MDIyMDQ1LCJzZXNzaW9uX3N0YXRlIjoiZjU0MWNmYTMtZDlhNS00NmZjLWExOTAtZTJiZmI0ZTQ5NzFhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwczovL3M1NDktZW1wcmVzYS5kZXYub2NwLmRyZWFkcy5ibmIiLCJodHRwOi8vbG9jYWxob3N0OjMwMDAiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbIm9mZmxpbmVfYWNjZXNzIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6Im9wZW5pZCIsInVzZXJGZWRlcmF0aW9uIjoiRVhUUkEiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJjMDE3NDM2IiwiY25waiI6IjczMTQxOTM5MDAwMTQwIiwiZ2l2ZW5fbmFtZSI6IkJydW5vIEJKLiBKb3Jkw6NvIiwibm9tZVRyYXRhbWVudG8iOiJCcnVubyJ9.O_ClhNiv8RwZ5pGLNZFAm0EYprfMEusDlzySznkJwGcGEUGWT99bLU1wcUm6dGTCmRJiA1c0_igNdsc-pg0mTJWn9aM3sQBhzBMIep-dY04gTvNPnTcjfJGT30ven3yiHA3iXxVBi5g3ODy8Cl-nkMll5OvdUxON5sMIx8-aldtg2nzDoKZna-kMSERpOzY0uZBRZd0zjHAmt1d5Rbe7HSFmBn6spLOGW5K4WsZUzwrsMD3OVm8Lv-P-OMQpKAISWCZlmz1luMqxSEG3JMV_E2P9u19kjPWjWyH7uhEnDcEgt91LtLajk4hNDkiqqWNxAiIhOL829JrYfwO1zi_NrQ"'))
            .toBe('73141939000140');
    });

})

